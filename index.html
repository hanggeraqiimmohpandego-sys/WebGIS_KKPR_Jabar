<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Web GIS KKPR</title>
  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    body { margin:0; padding:0; font-family: Arial, sans-serif; }
    #map { height: 90vh; width: 100%; }
    h2 { text-align: center; margin: 10px 0; }
  </style>
</head>
<body>
  <h2>Web GIS KKPR</h2>
  <div id="map"></div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <script>
    // 1. Buat map
    var map = L.map('map').setView([-6.9, 107.6], 10); // ganti sesuai lokasi KKPR

    // 2. Tambahkan base map OSM
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    // 3. Load GeoJSON
    fetch("data/kkpr.json")
      .then(response => response.json())
      .then(data => {
        L.geoJSON(data, {
          onEachFeature: function(feature, layer) {
            const p = feature.properties;

            // Buat isi popup dalam format tabel
            const popupContent = `
              <table style="font-size:12px; border-collapse:collapse;">
                <tr><td><b>Nomor KKPR</b></td><td>: ${p.No_KKPR || "-"}</td></tr>
                <tr><td><b>Nama Pemohon</b></td><td>: ${p.Nama_Usaha || "-"}</td></tr>
                <tr><td><b>Kode KBLI</b></td><td>: ${p.KO_KBLI || "-"}</td></tr>
                <tr><td><b>Alamat</b></td><td>: ${p.Alamat || "-"}</td></tr>
                <tr><td><b>Desa/Kelurahan</b></td><td>: ${p.Desa_Kel || "-"}</td></tr>
                <tr><td><b>Kecamatan</b></td><td>: ${p.Kec || "-"}</td></tr>
                <tr><td><b>Kota/Kabupaten</b></td><td>: ${p.KoKab || "-"}</td></tr>
                <tr><td><b>Jenis KKPR yang Diterbitkan</b></td><td>: ${p.Jns_KKPR || "-"}</td></tr>
                <tr><td><b>Penerbit KKPR</b></td><td>: ${p.Penerbit || "-"}</td></tr>
                <tr><td><b>Tanggal Terbit Dokumen KKPR</b></td><td>: ${p.Tagl_Terbi || "-"}</td></tr>
                <tr><td><b>Dasar Pertimbangan Penerbitan KKPR</b></td><td>: ${p.Ket_KKPR || "-"}</td></tr>
                <tr><td><b>Luas KKPR berdasarkan Dokumen</b></td><td>: ${p.Luas_KKPR || "-"} mÂ²</td></tr>
              </table>
              <br>
              <a href="lampiran/${p.No_KKPR || 'No_KKPR'}.pdf" target="_blank">
                ðŸ“„ Lihat Lampiran PDF
              </a>
            `;

            layer.bindPopup(popupContent);
          }
        }).addTo(map);
      })
      .catch(err => console.log("Error loading GeoJSON:", err));
  </script>
</body>
</html>
